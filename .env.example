# datos-gob-es-mcp Environment Variables

# =============================================================================
# AEMET OpenData API Key
# Get your free API key at: https://opendata.aemet.es/centrodedescargas/altaUsuario
# =============================================================================
AEMET_API_KEY=your_aemet_api_key_here

# =============================================================================
# Logging Configuration
# =============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR (default: INFO)
LOG_LEVEL=INFO

# Log format: console (human-readable) or json (for production/parsing)
LOG_FORMAT=console

# =============================================================================
# Webhooks Configuration
# =============================================================================
# Optional: Webhook secret for validating callbacks (HMAC signature)
WEBHOOK_SECRET=your_webhook_secret_here

# =============================================================================
# Base URLs (override defaults for testing or alternative environments)
# =============================================================================
DATOS_GOB_BASE_URL=https://datos.gob.es/apidata/
INE_BASE_URL=https://servicios.ine.es/wstempus/js/
BOE_BASE_URL=https://www.boe.es/datosabiertos/api/
AEMET_BASE_URL=https://opendata.aemet.es/opendata/api/

# =============================================================================
# HTTP Timeouts (seconds)
# =============================================================================
HTTP_DEFAULT_TIMEOUT=30.0
PREVIEW_TIMEOUT=10.0
DOWNLOAD_TIMEOUT=120.0
RATE_LIMIT_TIMEOUT=30.0

# =============================================================================
# Rate Limiting Configuration (requests per second)
# =============================================================================
# datos.gob.es API (default: 10)
RATE_LIMIT_DATOS_GOB_ES=10

# INE API (default: 5 - more conservative)
RATE_LIMIT_INE=5

# AEMET API (default: 10)
RATE_LIMIT_AEMET=10

# BOE API (default: 10)
RATE_LIMIT_BOE=10

# =============================================================================
# Pagination and Results
# =============================================================================
DEFAULT_PAGE_SIZE=50
MAX_SEARCH_RESULTS=50
DEFAULT_PREVIEW_ROWS=10
MAX_PREVIEW_ROWS=50

# =============================================================================
# Cache Configuration
# =============================================================================
# Cache time-to-live in hours (default: 24)
CACHE_TTL_HOURS=24

# Cache directory (default: ~/.cache/datos-gob-es)
CACHE_DIR=~/.cache/datos-gob-es

# =============================================================================
# Download Limits
# =============================================================================
# Max bytes for preview downloads (default: 100KB)
PREVIEW_MAX_BYTES=102400

# Max bytes for full downloads (default: 50MB)
DOWNLOAD_MAX_BYTES=52428800

# Max MB for download_data tool (default: 50)
MAX_DOWNLOAD_MB=50

# =============================================================================
# Semantic Search Configuration
# =============================================================================
# Model for embeddings (requires sentence-transformers)
SEMANTIC_MODEL_NAME=intfloat/multilingual-e5-small

# Minimum similarity score for results (0.0-1.0)
SEMANTIC_MIN_SCORE=0.5

# Max results from semantic ranking
SEMANTIC_TOP_K=20

# Max candidates for semantic filtering
MAX_SEMANTIC_CANDIDATES=500

# =============================================================================
# Processing Limits
# =============================================================================
# Max length for description truncation
DESCRIPTION_MAX_LENGTH=200

# Max keywords to extract from query
MAX_KEYWORDS=5

# Pages to fetch in parallel
PARALLEL_PAGES=5

# Max rows for statistics calculation
MAX_STATS_ROWS=1000

# =============================================================================
# INE (Instituto Nacional de Estadistica) Specific
# =============================================================================
INE_MAX_TABLES=100
INE_MAX_DATA_RECORDS=500
INE_DEFAULT_NLAST=10

# =============================================================================
# BOE (Boletin Oficial del Estado) Specific
# =============================================================================
BOE_DEFAULT_SEARCH_DAYS=30
BOE_MAX_SEARCH_DAYS=90
BOE_BATCH_SIZE=5
BOE_MAX_RESULTS=50

# =============================================================================
# AEMET (Agencia Estatal de Meteorologia) Specific
# =============================================================================
AEMET_MAX_FORECAST_DAYS=7
AEMET_MAX_OBSERVATIONS=50
AEMET_MAX_MUNICIPALITIES=500

# =============================================================================
# HTTP Connection Pool (Performance)
# =============================================================================
# Max keep-alive connections per host
HTTP_POOL_MAX_KEEPALIVE=10

# Max total connections per host
HTTP_POOL_MAX_CONNECTIONS=20

# Enable HTTP/2 for multiplexing (better performance)
HTTP2_ENABLED=true

# =============================================================================
# Embeddings Performance
# =============================================================================
# Batch size for encoding multiple texts (higher = faster but more memory)
EMBEDDINGS_BATCH_SIZE=32

# Pre-load embeddings model at startup (slower startup but faster first search)
PRELOAD_EMBEDDINGS_MODEL=false
